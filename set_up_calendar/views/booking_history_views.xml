<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="booking_history_tree_view" model="ir.ui.view">
            <field name="name">booking.history.form</field>
            <field name="model">booking.history</field>
            <field name="arch" type="xml">
                <tree string="Lịch đặt thiết bị" default_order="start desc" >
                    <field name="equipment_id"/>
                    <field name="start"/>
                    <field name="stop"/>
                    <field name="user_id"/>
                    <field name="duration"/>
                </tree>
            </field>
        </record>

<!--        <record id="booking_history_search_view" model="ir.ui.view">-->
<!--            <field name="name">booking.history.search</field>-->
<!--            <field name="model">booking.history</field>-->
<!--            <field name="arch" type="xml">-->
<!--                <search string="Search booking history">-->
<!--                    <field name="equipment_id" string=" "-->
<!--                           filter_domain="['|',('equipment_id', 'ilike', self),('user_id', 'ilike', self)]"/>-->
<!--                    <field name="equipment_id"/>-->
<!--                    <field name="user_id"/>-->
<!--                    &lt;!&ndash;                    <field name="duration"/>&ndash;&gt;-->
<!--                    &lt;!&ndash;                    <field name="start"/>&ndash;&gt;-->
<!--                    &lt;!&ndash;                    <field name="stop"/>&ndash;&gt;-->
<!--                </search>-->
<!--            </field>-->
<!--        </record>-->

<!--        filter-->
        <record id="view_time_end_event_search" model="ir.ui.view">
            <field name="name">time.search</field>
            <field name="model">booking.history</field>
            <field name="arch" type="xml">
                <search string="filter_time">
                    <field name="equipment_id" string="Tên thiết bị"
                           filter_domain="['|',('equipment_id', 'ilike', self),('user_id', 'ilike', self)]"/>
                    <field name="user_id"/>
                    <filter string="Time" name="filter_stop_time_event" date="stop"/>
                    <separator/>
                    <filter string="This day" name="this_day" domain="[
                        ('stop','&lt;=', datetime.datetime.combine(context_today() + relativedelta(days=1), datetime.time(0,0,0)).strftime('%Y-%m-%d 00:00:00')),
                        ('stop','&gt;=', datetime.datetime.combine(context_today() + relativedelta(days=-1), datetime.time(23,59,59)).strftime('%Y-%m-%d 23:59:59'))
                    ]" />
                    <filter string="This week" name="this_week" domain="[
                        ('stop', '&lt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=0, days=0, weekday=0), datetime.time(0,0,0)).strftime('%Y-%m-%d')),
                        ('stop', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-2, days=6, weekday=6), datetime.time(0,0,0)).strftime('%Y-%m-%d'))
                    ]"/>
                    <separator/>
                    <filter string="Next 7 days" name="next_7days" domain="[
                        ('stop', '&gt;=', datetime.datetime.combine(datetime.datetime.now(), datetime.time(0,0,0)).strftime('%Y-%m-%d')),
                        ('stop', '&lt;=', datetime.datetime.combine(context_today() + relativedelta(days=7), datetime.time(0,0,0)).strftime('%Y-%m-%d'))
                    ]"/>
                    <filter string="Next 30 days" name="next_30days" domain="[
                        ('stop', '&gt;=', datetime.datetime.combine(context_today(), datetime.time(0,0,0)).strftime('%Y-%m-%d')),
                        ('stop', '&lt;=', datetime.datetime.combine(context_today() + relativedelta(days=30), datetime.time(0,0,0)).strftime('%Y-%m-%d'))
                    ]"/>
                    <separator/>
                    <filter string="Last week" name="last_week" domain="[
                        ('stop', '&lt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-1, days=0, weekday=0), datetime.time(0,0,0)).strftime('%Y-%m-%d')),
                        ('stop', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-3, days=6, weekday=6), datetime.time(0,0,0)).strftime('%Y-%m-%d'))
                    ]"/>
                    <separator/>
                    <filter string="Next week" name="next_week" domain="[
                        ('stop', '&lt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=1, days=0, weekday=0), datetime.time(0,0,0)).strftime('%Y-%m-%d')),
                        ('stop', '&gt;=', datetime.datetime.combine(context_today() + relativedelta(weeks=-1, days=6, weekday=6), datetime.time(0,0,0)).strftime('%Y-%m-%d'))
                    ]"/>
                    <filter string="Next month" name="next_month" domain="[
                        ('stop','&lt;=', (datetime.datetime.now()+relativedelta(months=2)).strftime('%Y-%m-01')),
                        ('stop','&gt;=', (datetime.datetime.now()+relativedelta(months=1)).strftime('%Y-%m-01'))
                    ]"/>
                    <filter string="Next year" name="next_year" domain="[
                        ('stop','&lt;=', datetime.datetime.combine(context_today() + relativedelta(days=365), datetime.time(23,59,59)).strftime('%%Y-12-31 23:59:59')),
                        ('stop','&gt;=', datetime.datetime.combine(context_today() + relativedelta(days=365), datetime.time(0,0,0)).strftime('%%Y-01-01 00:00:00'))
                        ]"/>
                    <separator/>
                    <filter string="Future" name="filter_future_event"
                            domain="[('stop', '>',datetime.datetime.now().strftime('%Y-%m-%d'))]"/>

<!--                    group-->
                    <filter name="equipment" string="Thiết bị" icon="terp-partner"
                            context="{'group_by':'equipment_id'}"/>
                    <filter name="user" string="Người dùng" icon="terp-partner"
                            context="{'group_by':'user_id'}"/>
                </search>
            </field>
        </record>

        <!--        event calendar-->
        <record model="ir.ui.view" id="view_calendar_order_history">
            <field name="name">view.alendar.order.history</field>
            <field name="model">booking.history</field>
            <field name="arch" type="xml">
                <calendar string="Order History" date_start="start" date_stop="stop" date_delay="duration" color="equipment_id">
                    <field name="equipment_id"/>
<!--                    <field name="equipment_id" options="{'block': True, 'icon': 'fa fa-users'}"-->
<!--                           filters="1" widget="many2manyattendee" write_model="calendar.filters"-->
<!--                           write_field="equipment_id"-->
<!--                    />-->
                </calendar>
            </field>
        </record>

        <record id="booking_history_act_window" model="ir.actions.act_window">
            <field name="name">Lịch đặt thiết bị</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">booking.history</field>
            <field name="context">{"this_day": 1}</field>
            <field name="view_mode">calendar,tree</field>
            <field name="context">{"search_default_this_day":1}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    There is no examples click here to add new booking.
                </p>
            </field>
        </record>

    </data>
</odoo>